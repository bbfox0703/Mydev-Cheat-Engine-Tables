<?xml version="1.0" encoding="utf-8"?>
<CheatTable CheatEngineTableVersion="45">
  <CheatEntries>
    <CheatEntry>
      <ID>29</ID>
      <Description>"_Debug"</Description>
      <Options moHideChildren="1" moDeactivateChildrenAsWell="1"/>
      <GroupHeader>1</GroupHeader>
      <CheatEntries>
        <CheatEntry>
          <ID>11</ID>
          <Description>"Get container / basket size(open basket or container)"</Description>
          <Options moHideChildren="1"/>
          <VariableType>Auto Assembler Script</VariableType>
          <AssemblerScript>{ Game   : Atelier_Ryza.exe
  Version: 
  Date   : 2022-11-12
  Author : bbfox@https://opencheattables.com
}

[ENABLE]

aobscanmodule(INJECT_GET_BASKET_ADDR,$process,8B 4B 0C 2B C8) // should be unique
alloc(newmem,$1000,INJECT_GET_BASKET_ADDR)

label(code)
label(return)
label(i_basket_addr)
newmem:
  cmp qword ptr [i_basket_addr], 0
  jne code
  mov [i_basket_addr], rbx

code:
  mov ecx,[rbx+0C]
  sub ecx,eax
  jmp return
align 10 cc
  i_basket_addr:
  dq 0


INJECT_GET_BASKET_ADDR:
  jmp newmem
return:
registersymbol(INJECT_GET_BASKET_ADDR)
registersymbol(i_basket_addr)
[DISABLE]

INJECT_GET_BASKET_ADDR:
  db 8B 4B 0C 2B C8

unregistersymbol(*)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: Atelier_Ryza.exe+1798FF

Atelier_Ryza.exe+1798E8: 48 03 41 18     - add rax,[rcx+18]
Atelier_Ryza.exe+1798EC: C3              - ret 
Atelier_Ryza.exe+1798ED: CC              - int 3 
Atelier_Ryza.exe+1798EE: CC              - int 3 
Atelier_Ryza.exe+1798EF: CC              - int 3 
Atelier_Ryza.exe+1798F0: 40 53           - push rbx
Atelier_Ryza.exe+1798F2: 48 83 EC 20     - sub rsp,20
Atelier_Ryza.exe+1798F6: 48 8B 01        - mov rax,[rcx]
Atelier_Ryza.exe+1798F9: 48 8B D9        - mov rbx,rcx
Atelier_Ryza.exe+1798FC: FF 50 10        - call qword ptr [rax+10]
// ---------- INJECTING HERE ----------
Atelier_Ryza.exe+1798FF: 8B 4B 0C        - mov ecx,[rbx+0C]
// ---------- DONE INJECTING  ----------
Atelier_Ryza.exe+179902: 2B C8           - sub ecx,eax
Atelier_Ryza.exe+179904: 8B C1           - mov eax,ecx
Atelier_Ryza.exe+179906: 48 83 C4 20     - add rsp,20
Atelier_Ryza.exe+17990A: 5B              - pop rbx
Atelier_Ryza.exe+17990B: C3              - ret 
Atelier_Ryza.exe+17990C: CC              - int 3 
Atelier_Ryza.exe+17990D: CC              - int 3 
Atelier_Ryza.exe+17990E: CC              - int 3 
Atelier_Ryza.exe+17990F: CC              - int 3 
Atelier_Ryza.exe+179910: 48 89 5C 24 08  - mov [rsp+08],rbx
}
</AssemblerScript>
          <CheatEntries>
            <CheatEntry>
              <ID>12</ID>
              <Description>"Addr."</Description>
              <ShowAsHex>1</ShowAsHex>
              <ShowAsSigned>0</ShowAsSigned>
              <Color>808080</Color>
              <VariableType>8 Bytes</VariableType>
              <Address>i_basket_addr</Address>
            </CheatEntry>
            <CheatEntry>
              <ID>13</ID>
              <Description>"Size"</Description>
              <ShowAsSigned>0</ShowAsSigned>
              <Color>808080</Color>
              <VariableType>4 Bytes</VariableType>
              <Address>i_basket_addr</Address>
              <Offsets>
                <Offset>C</Offset>
              </Offsets>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
        <CheatEntry>
          <ID>9549</ID>
          <Description>"Get container / basket address"</Description>
          <Options moHideChildren="1"/>
          <VariableType>Auto Assembler Script</VariableType>
          <AssemblerScript>{ Game   : Atelier_Ryza_3.exe
  Version: 
  Date   : 2023-03-25
  Author : bbfox@https://opencheattables.com
}

[ENABLE]

aobscanmodule(INJECT_GET_CONT_ADDR,Atelier_Ryza_3.exe,0F BE 43 02 48 83 C4 20 5B C3 CC) // should be unique
alloc(newmem,$1000,INJECT_GET_CONT_ADDR)

label(code)
label(return)
label(i_base_cont_addr_1)

newmem:
  cmp qword ptr [i_base_cont_addr_1], 0
  jne code
  mov [i_base_cont_addr_1], rbx

code:
  movsx eax,byte ptr [rbx+02]
  add rsp,20
  jmp return
align 10 cc
  i_base_cont_addr_1:
  dq 0


INJECT_GET_CONT_ADDR:
  jmp newmem
  nop 3
return:
registersymbol(INJECT_GET_CONT_ADDR)
registersymbol(i_base_cont_addr_1)
[DISABLE]

INJECT_GET_CONT_ADDR:
  db 0F BE 43 02 48 83 C4 20

unregistersymbol(*)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: Atelier_Ryza_3.exe+67EF45

Atelier_Ryza_3.exe+67EF25: 0F BE 43 0A           - movsx eax,byte ptr [rbx+0A]
Atelier_Ryza_3.exe+67EF29: 48 83 C4 20           - add rsp,20
Atelier_Ryza_3.exe+67EF2D: 5B                    - pop rbx
Atelier_Ryza_3.exe+67EF2E: C3                    - ret 
Atelier_Ryza_3.exe+67EF2F: CC                    - int 3 
Atelier_Ryza_3.exe+67EF30: 40 53                 - push rbx
Atelier_Ryza_3.exe+67EF32: 48 83 EC 20           - sub rsp,20
Atelier_Ryza_3.exe+67EF36: 48 8B D9              - mov rbx,rcx
Atelier_Ryza_3.exe+67EF39: 48 8D 0D 65 84 18 02  - lea rcx,[Atelier_Ryza_3.exe+28073A5]
Atelier_Ryza_3.exe+67EF40: E8 FB 45 C0 00        - call Atelier_Ryza_3.exe+1283540
// ---------- INJECTING HERE ----------
Atelier_Ryza_3.exe+67EF45: 0F BE 43 02           - movsx eax,byte ptr [rbx+02]
// ---------- DONE INJECTING  ----------
Atelier_Ryza_3.exe+67EF49: 48 83 C4 20           - add rsp,20
Atelier_Ryza_3.exe+67EF4D: 5B                    - pop rbx
Atelier_Ryza_3.exe+67EF4E: C3                    - ret 
Atelier_Ryza_3.exe+67EF4F: CC                    - int 3 
Atelier_Ryza_3.exe+67EF50: 40 53                 - push rbx
Atelier_Ryza_3.exe+67EF52: 48 83 EC 20           - sub rsp,20
Atelier_Ryza_3.exe+67EF56: 48 8B D9              - mov rbx,rcx
Atelier_Ryza_3.exe+67EF59: 48 8D 0D 45 84 18 02  - lea rcx,[Atelier_Ryza_3.exe+28073A5]
Atelier_Ryza_3.exe+67EF60: E8 DB 45 C0 00        - call Atelier_Ryza_3.exe+1283540
Atelier_Ryza_3.exe+67EF65: 0F BF 4B 04           - movsx ecx,word ptr [rbx+04]
}
</AssemblerScript>
          <CheatEntries>
            <CheatEntry>
              <ID>9550</ID>
              <Description>"Addr."</Description>
              <ShowAsHex>1</ShowAsHex>
              <ShowAsSigned>0</ShowAsSigned>
              <VariableType>8 Bytes</VariableType>
              <Address>i_base_cont_addr_1</Address>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
        <CheatEntry>
          <ID>20</ID>
          <Description>"Ryza HP"</Description>
          <Color>FF8080</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>Atelier_Ryza.exe+147D22C</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>36</ID>
          <Description>"Ryza EXP"</Description>
          <ShowAsSigned>0</ShowAsSigned>
          <VariableType>4 Bytes</VariableType>
          <Address>Atelier_Ryza.exe+147D228 </Address>
        </CheatEntry>
        <CheatEntry>
          <ID>9530</ID>
          <Description>"_WIP"</Description>
          <Options moHideChildren="1" moDeactivateChildrenAsWell="1"/>
          <GroupHeader>1</GroupHeader>
          <CheatEntries>
            <CheatEntry>
              <ID>42</ID>
              <Description>"Battle: MP does not decrease"</Description>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Atelier_Ryza.exe
  Version: 
  Date   : 2022-11-12
  Author : bbfox@https://opencheattables.com
}

[ENABLE]

aobscanmodule(INJECT_BATTLE_MP,Atelier_Ryza.exe,29 91 10 01 00 00) // should be unique
alloc(newmem,$1000,INJECT_BATTLE_MP)

label(code)
label(return)

newmem:

code:
  //sub [rcx+00000110],edx
  jmp return

INJECT_BATTLE_MP:
  jmp newmem
  nop
return:
registersymbol(INJECT_BATTLE_MP)

[DISABLE]

INJECT_BATTLE_MP:
  db 29 91 10 01 00 00

unregistersymbol(INJECT_BATTLE_MP)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: Atelier_Ryza.exe+219DCA

Atelier_Ryza.exe+219DB9: 5B                             - pop rbx
Atelier_Ryza.exe+219DBA: C3                             - ret 
Atelier_Ryza.exe+219DBB: CC                             - int 3 
Atelier_Ryza.exe+219DBC: CC                             - int 3 
Atelier_Ryza.exe+219DBD: CC                             - int 3 
Atelier_Ryza.exe+219DBE: CC                             - int 3 
Atelier_Ryza.exe+219DBF: CC                             - int 3 
Atelier_Ryza.exe+219DC0: 48 89 5C 24 08                 - mov [rsp+08],rbx
Atelier_Ryza.exe+219DC5: 57                             - push rdi
Atelier_Ryza.exe+219DC6: 48 83 EC 30                    - sub rsp,30
// ---------- INJECTING HERE ----------
Atelier_Ryza.exe+219DCA: 29 91 10 01 00 00              - sub [rcx+00000110],edx
// ---------- DONE INJECTING  ----------
Atelier_Ryza.exe+219DD0: 8B FA                          - mov edi,edx
Atelier_Ryza.exe+219DD2: 83 B9 10 01 00 00 00           - cmp dword ptr [rcx+00000110],00
Atelier_Ryza.exe+219DD9: 48 8B D9                       - mov rbx,rcx
Atelier_Ryza.exe+219DDC: 7D 0A                          - jnl Atelier_Ryza.exe+219DE8
Atelier_Ryza.exe+219DDE: C7 81 10 01 00 00 00 00 00 00  - mov [rcx+00000110],00000000
Atelier_Ryza.exe+219DE8: 85 FF                          - test edi,edi
Atelier_Ryza.exe+219DEA: 74 7F                          - je Atelier_Ryza.exe+219E6B
Atelier_Ryza.exe+219DEC: 48 8B 01                       - mov rax,[rcx]
Atelier_Ryza.exe+219DEF: BA 9A 00 00 00                 - mov edx,0000009A
Atelier_Ryza.exe+219DF4: FF 90 D0 01 00 00              - call qword ptr [rax+000001D0]
}
</AssemblerScript>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
  </CheatEntries>
  <UserdefinedSymbols/>
</CheatTable>
