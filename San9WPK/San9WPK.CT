<?xml version="1.0" encoding="utf-8"?>
<CheatTable CheatEngineTableVersion="45">
  <CheatEntries>
    <CheatEntry>
      <ID>1</ID>
      <Description>"新武將：兵法無限"</Description>
      <VariableType>Auto Assembler Script</VariableType>
      <AssemblerScript>{ Game   : San9WPK.exe
  Version: 
  Date   : 2024-10-05
  Author :
}

[ENABLE]

aobscanmodule(INJECT_INF_SKPT,$process,89 86 58 39 00 00 33) // should be unique
alloc(newmem,$1000)

label(code)
label(return)
label(i_base_sk_addr)

newmem:
  mov [i_base_sk_addr], esi
  mov eax, [esi+00003958]
  cmp eax, #35
  jae code
  mov eax, #35
code:
  mov [esi+00003958],eax
  jmp return
align 10 cc
  i_base_sk_addr:
  dd 0

INJECT_INF_SKPT:
  jmp newmem
  nop
return:
registersymbol(INJECT_INF_SKPT)
registersymbol(i_base_sk_addr)
[DISABLE]

INJECT_INF_SKPT:
  db 89 86 58 39 00 00

unregistersymbol(*)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: San9WPK.exe+162813

San9WPK.exe+1627F5: 50                 - push eax
San9WPK.exe+1627F6: 57                 - push edi
San9WPK.exe+1627F7: B9 A8 E3 50 01     - mov ecx,San9WPK.exe+110E3A8
San9WPK.exe+1627FC: E8 DF CA EE FF     - call San9WPK.exe+4F2E0
San9WPK.exe+162801: 47                 - inc edi
San9WPK.exe+162802: 83 FF 1F           - cmp edi,1F
San9WPK.exe+162805: 7C E0              - jl San9WPK.exe+1627E7
San9WPK.exe+162807: 68 A8 E3 50 01     - push San9WPK.exe+110E3A8
San9WPK.exe+16280C: 8B CE              - mov ecx,esi
San9WPK.exe+16280E: E8 DD D9 FF FF     - call San9WPK.exe+1601F0
// ---------- INJECTING HERE ----------
San9WPK.exe+162813: 89 86 58 39 00 00  - mov [esi+00003958],eax
// ---------- DONE INJECTING  ----------
San9WPK.exe+162819: 33 FF              - xor edi,edi
San9WPK.exe+16281B: EB 03              - jmp San9WPK.exe+162820
San9WPK.exe+16281D: 8D 49 00           - lea ecx,[ecx+00]
San9WPK.exe+162820: 57                 - push edi
San9WPK.exe+162821: B9 A8 E3 50 01     - mov ecx,San9WPK.exe+110E3A8
San9WPK.exe+162826: E8 A5 CA EE FF     - call San9WPK.exe+4F2D0
San9WPK.exe+16282B: 85 C0              - test eax,eax
San9WPK.exe+16282D: 74 1A              - je San9WPK.exe+162849
San9WPK.exe+16282F: 6A 01              - push 01
San9WPK.exe+162831: 8D 9F 01 04 00 00  - lea ebx,[edi+00000401]
}
</AssemblerScript>
      <CheatEntries>
        <CheatEntry>
          <ID>2</ID>
          <Description>"Skill PT"</Description>
          <ShowAsSigned>0</ShowAsSigned>
          <VariableType>4 Bytes</VariableType>
          <Address>i_base_sk_addr</Address>
          <Offsets>
            <Offset>3958</Offset>
          </Offsets>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
    <CheatEntry>
      <ID>4</ID>
      <Description>"新武將：Attr"</Description>
      <VariableType>Auto Assembler Script</VariableType>
      <AssemblerScript>{ Game   : San9WPK.exe
  Version: 
  Date   : 2024-10-05
  Author :
}

[ENABLE]

aobscanmodule(INJECT_NEW_CHAR_GET_ATTR,San9WPK.exe,89 41 54 C2 08 00) // should be unique
alloc(newmem,$1000)

label(code)
label(return)
label(i_base_new_char_addr)

newmem:
  mov [i_base_new_char_addr], ecx

code:
  mov [ecx+54],eax
  ret 0008
  jmp return
align 10 cc
  i_base_new_char_addr:
  dd 0

INJECT_NEW_CHAR_GET_ATTR:
  jmp newmem
  nop
return:
registersymbol(INJECT_NEW_CHAR_GET_ATTR)
registersymbol(i_base_new_char_addr)
[DISABLE]

INJECT_NEW_CHAR_GET_ATTR:
  db 89 41 54 C2 08 00

unregistersymbol(*)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: San9WPK.exe+4EF08

San9WPK.exe+4EEE4: 83 F8 03              - cmp eax,03
San9WPK.exe+4EEE7: 77 2C                 - ja San9WPK.exe+4EF15
San9WPK.exe+4EEE9: FF 24 85 18 EF 44 00  - jmp dword ptr [eax*4+San9WPK.exe+4EF18]
San9WPK.exe+4EEF0: 8B 44 24 08           - mov eax,[esp+08]
San9WPK.exe+4EEF4: 89 41 64              - mov [ecx+64],eax
San9WPK.exe+4EEF7: C2 08 00              - ret 0008
San9WPK.exe+4EEFA: 8B 54 24 08           - mov edx,[esp+08]
San9WPK.exe+4EEFE: 89 51 4C              - mov [ecx+4C],edx
San9WPK.exe+4EF01: C2 08 00              - ret 0008
San9WPK.exe+4EF04: 8B 44 24 08           - mov eax,[esp+08]
// ---------- INJECTING HERE ----------
San9WPK.exe+4EF08: 89 41 54              - mov [ecx+54],eax
// ---------- DONE INJECTING  ----------
San9WPK.exe+4EF0B: C2 08 00              - ret 0008
San9WPK.exe+4EF0E: 8B 54 24 08           - mov edx,[esp+08]
San9WPK.exe+4EF12: 89 51 5C              - mov [ecx+5C],edx
San9WPK.exe+4EF15: C2 08 00              - ret 0008
San9WPK.exe+4EF18: F0 EE                 - lock out dx,al
San9WPK.exe+4EF1A: 44                    - inc esp
San9WPK.exe+4EF1B: 00 FA                 - add dl,bh
San9WPK.exe+4EF1D: EE                    - out dx,al
San9WPK.exe+4EF1E: 44                    - inc esp
San9WPK.exe+4EF1F: 00 04 EF              - add [edi+ebp*8],al
}
</AssemblerScript>
      <CheatEntries>
        <CheatEntry>
          <ID>5</ID>
          <Description>"武力"</Description>
          <ShowAsSigned>0</ShowAsSigned>
          <VariableType>4 Bytes</VariableType>
          <Address>i_base_new_char_addr</Address>
          <Offsets>
            <Offset>4C</Offset>
          </Offsets>
        </CheatEntry>
        <CheatEntry>
          <ID>6</ID>
          <Description>"知力"</Description>
          <ShowAsSigned>0</ShowAsSigned>
          <VariableType>4 Bytes</VariableType>
          <Address>i_base_new_char_addr</Address>
          <Offsets>
            <Offset>54</Offset>
          </Offsets>
        </CheatEntry>
        <CheatEntry>
          <ID>7</ID>
          <Description>"政治"</Description>
          <ShowAsSigned>0</ShowAsSigned>
          <VariableType>4 Bytes</VariableType>
          <Address>i_base_new_char_addr</Address>
          <Offsets>
            <Offset>5C</Offset>
          </Offsets>
        </CheatEntry>
        <CheatEntry>
          <ID>8</ID>
          <Description>"統率"</Description>
          <ShowAsSigned>0</ShowAsSigned>
          <VariableType>4 Bytes</VariableType>
          <Address>i_base_new_char_addr</Address>
          <Offsets>
            <Offset>64</Offset>
          </Offsets>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
  </CheatEntries>
  <UserdefinedSymbols/>
</CheatTable>
